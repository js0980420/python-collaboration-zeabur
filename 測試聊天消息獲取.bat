@echo off\nchcp 65001 >nul\necho.\necho ==========================================\necho 🔍 聊天消息獲取測試\necho ==========================================\necho.\n\necho 📋 測試不同 lastChatId 值的聊天消息獲取：\necho.\n\necho 🧪 測試1: lastChatId=0 (獲取所有消息)...\npowershell -Command \"try { $response = Invoke-WebRequest -Uri 'http://localhost/collaboration/code_sync_handler.php?action=get_updates' -Method POST -Headers @{'Content-Type'='application/json'} -Body '{\\\"action\\\":\\\"get_updates\\\",\\\"room\\\":\\\"test_room\\\",\\\"userId\\\":\\\"test_receiver\\\",\\\"userName\\\":\\\"測試接收者\\\",\\\"lastVersion\\\":18,\\\"lastChatId\\\":0}'; Write-Host '✅ 回應:'; $jsonResponse = $response.Content | ConvertFrom-Json; $jsonResponse.updates | Where-Object { $_.type -eq 'chat_message' } | ForEach-Object { Write-Host '💬 聊天消息:' $_.data.message '(ID:' $_.data.chatId ')' } } catch { Write-Host '❌ 錯誤:' $_.Exception.Message }\"\n\necho.\necho 🧪 測試2: lastChatId=2 (獲取ID>2的消息)...\npowershell -Command \"try { $response = Invoke-WebRequest -Uri 'http://localhost/collaboration/code_sync_handler.php?action=get_updates' -Method POST -Headers @{'Content-Type'='application/json'} -Body '{\\\"action\\\":\\\"get_updates\\\",\\\"room\\\":\\\"test_room\\\",\\\"userId\\\":\\\"test_receiver\\\",\\\"userName\\\":\\\"測試接收者\\\",\\\"lastVersion\\\":18,\\\"lastChatId\\\":2}'; Write-Host '✅ 回應:'; $jsonResponse = $response.Content | ConvertFrom-Json; $jsonResponse.updates | Where-Object { $_.type -eq 'chat_message' } | ForEach-Object { Write-Host '💬 聊天消息:' $_.data.message '(ID:' $_.data.chatId ')' } } catch { Write-Host '❌ 錯誤:' $_.Exception.Message }\"\n\necho.\necho 🧪 測試3: lastChatId=4 (獲取ID>4的消息)...\npowershell -Command \"try { $response = Invoke-WebRequest -Uri 'http://localhost/collaboration/code_sync_handler.php?action=get_updates' -Method POST -Headers @{'Content-Type'='application/json'} -Body '{\\\"action\\\":\\\"get_updates\\\",\\\"room\\\":\\\"test_room\\\",\\\"userId\\\":\\\"test_receiver\\\",\\\"userName\\\":\\\"測試接收者\\\",\\\"lastVersion\\\":18,\\\"lastChatId\\\":4}'; Write-Host '✅ 回應:'; $jsonResponse = $response.Content | ConvertFrom-Json; $jsonResponse.updates | Where-Object { $_.type -eq 'chat_message' } | ForEach-Object { Write-Host '💬 聊天消息:' $_.data.message '(ID:' $_.data.chatId ')' } } catch { Write-Host '❌ 錯誤:' $_.Exception.Message }\"\n\necho.\necho 📊 數據庫中的聊天消息:\nmysql -u root -e \"USE python_collaboration; SELECT id, user_id, user_name, message, created_at FROM chat_messages WHERE room_id = 12 ORDER BY created_at DESC;\"\n\necho.\necho ✅ 測試完成！\npause 